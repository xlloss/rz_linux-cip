// SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
/*
 * Device Tree Source for the RZ/G2UL Type-1 SMARC EVK board
 *
 * Copyright (C) 2022 Renesas Electronics Corp.
 */

/dts-v1/;
#include "r9a07g043.dtsi"
#include "rzg2ul-smarc.dtsi"

#define FATEK_MODIFY    1
#define FATEK_TEST      0

#if FATEK_MODIFY
/ {
	model = "Renesas SMARC EVK based on r9a07g043u11 0227a slash";
	compatible = "renesas,smarc-evk", "renesas,r9a07g043u11", "renesas,r9a07g043";

	memory@40200000 {
		device_type = "memory";
		/* first 2MB is reserved for secure area. */
		reg = <0 0x40200000 0 0x1FE00000>;
	};

	aliases {
		/delete-property/ ethernet1;
		i2c0 = &i2c0;
		i2c1 = &i2c1;
		serial0 = &scif0;
		serial1 = &scif1;
		serial2 = &scif2;
		serial3 = &scif4;
		serial4 = &sci1;
	};

	reserved-memory {
		#address-cells = <2>;
		#size-cells = <2>;
		ranges;

		/delete-node/ linux,cma@58000000;
		/delete-node/ linux,multimedia;

		global_cma: linux,cma@50000000 {
			compatible = "shared-dma-pool";
			linux,cma-default;
			reusable;
			/* 128MB is reserved for CMA */
			reg = <0x0 0x5BFFFFFF 0x0 0x2000000>;
		};
		mmp_reserved: linux,multimedia {
			compatible = "shared-dma-pool";
			reusable;
			/* 128MB is reserved for CMA */
			reg = <0x00000000 0x5DFFFFFF 0x0 0x2000000>;
		};
	};

	/delete-node/ sound;
	/delete-node/ clk_ext_camera;
	/delete-node/ memory@48000000;
	/delete-node/ regulator-vccq-sdhi1;
	/delete-node/ vccq_sdhi1;
};

&soc {
	/delete-node/ canfd;
	/delete-node/ can@10050000;
	/delete-node/ adc@10059000;
	/delete-node/ csi2@10830400;
	/delete-node/ video@10830000;
	/delete-node/ ethernet@11c30000;
};

&pinctrl {
	/delete-node/ can0;
	/delete-node/ can1;
	/delete-node/ eth1;
	/delete-node/ sdhi0_pins;
	/delete-node/ sdhi0_pins_uhs;
	/delete-node/ ssi1;

	gpio_pins: gpio {
		pinmux = <RZG2L_PORT_PINMUX(5,2,0)>, /* P5_2 */
				 <RZG2L_PORT_PINMUX(5,4,0)>, /* P5_4 */
				 <RZG2L_PORT_PINMUX(6,2,0)>, /* P6_2 */
				 <RZG2L_PORT_PINMUX(7,4,0)>, /* P7_4 */
				 <RZG2L_PORT_PINMUX(8,2,0)>, /* P8_2 */
				 <RZG2L_PORT_PINMUX(8,3,0)>, /* P8_3 */
				 <RZG2L_PORT_PINMUX(8,4,0)>, /* P8_4 */
				 <RZG2L_PORT_PINMUX(9,3,0)>, /* P9_3 */
				 <RZG2L_PORT_PINMUX(10,4,0)>; /* P10_4 */
	};
	eth0_pins: eth0 {
		pinmux = <RZG2L_PORT_PINMUX(4,5,1)>, /* ET0_LINKSTA */
				 <RZG2L_PORT_PINMUX(4,3,1)>, /* ET0_MDC */
				 <RZG2L_PORT_PINMUX(4,4,1)>, /* ET0_MDIO */
				 <RZG2L_PORT_PINMUX(3,0,1)>, /* ET0_RXC/RX_CLK */
				 <RZG2L_PORT_PINMUX(3,2,1)>, /* ET0_RXD0 */
				 <RZG2L_PORT_PINMUX(3,3,1)>, /* ET0_RXD1 */
				 <RZG2L_PORT_PINMUX(4,0,1)>, /* ET0_RXD2 */
				 <RZG2L_PORT_PINMUX(4,1,1)>, /* ET0_RXD3 */
				 <RZG2L_PORT_PINMUX(3,1,1)>, /* ET0_RX_CTL/RX_DV */
				 <RZG2L_PORT_PINMUX(4,2,1)>, /* ET0_RX_ERR */
				 <RZG2L_PORT_PINMUX(1,0,1)>, /* ET0_TXC/TX_CLK */
				 <RZG2L_PORT_PINMUX(1,2,1)>, /* ET0_TXD0 */
				 <RZG2L_PORT_PINMUX(1,3,1)>, /* ET0_TXD1 */
				 <RZG2L_PORT_PINMUX(1,4,1)>, /* ET0_TXD2 */
				 <RZG2L_PORT_PINMUX(2,0,1)>, /* ET0_TXD3 */
				 <RZG2L_PORT_PINMUX(2,2,1)>, /* ET0_TX_COL */
				 <RZG2L_PORT_PINMUX(2,3,1)>, /* ET0_TX_CRS */
				 <RZG2L_PORT_PINMUX(1,1,1)>, /* ET0_TX_CTL/TX_EN */
				 <RZG2L_PORT_PINMUX(2,1,1)>; /* ET0_TX_ERR */
	};
	mtu3_pins: mtu3 {
		pinmux = <RZG2L_PORT_PINMUX(9,0,5)>; /* MTIOC4A_B */
	};
	rspi2_pins: rspi2 {
		pinmux = <RZG2L_PORT_PINMUX(7,0,3)>, /* RSPI2_CK_A */
				 <RZG2L_PORT_PINMUX(7,2,3)>, /* RSPI2_MISO_A */
				 <RZG2L_PORT_PINMUX(7,1,3)>, /* RSPI2_MOSI_A */
				 <RZG2L_PORT_PINMUX(7,3,3)>; /* RSPI2_SSL_A */
	};
	scif0_pins: scif0 {
		pinmux = <RZG2L_PORT_PINMUX(6,3,6)>, /* SCIF0_RXD_C */
				 <RZG2L_PORT_PINMUX(6,4,6)>; /* SCIF0_TXD_C */
	};
	scif1_pins: scif1 {
		pinmux = <RZG2L_PORT_PINMUX(8,0,3)>, /* SCIF1_RXD_B */
				 <RZG2L_PORT_PINMUX(8,1,3)>; /* SCIF1_TXD_B */
	};
	scif2_pins: scif2 {
		pinmux = <RZG2L_PORT_PINMUX(5,1,2)>, /* SCIF2_RXD_A */
				 <RZG2L_PORT_PINMUX(5,0,2)>; /* SCIF2_TXD_A */
	};
	scif4_pins: scif4 {
		pinmux = <RZG2L_PORT_PINMUX(9,1,6)>, /* SCIF4_RXD_A */
				 <RZG2L_PORT_PINMUX(9,2,6)>; /* SCIF4_TXD_A */
	};
	sci1_pins: sci1 {
		pinmux = <RZG2L_PORT_PINMUX(18,5,6)>, /* SCI1_RXD_C */
				 <RZG2L_PORT_PINMUX(18,4,6)>; /* SCI1_TXD_C */
	};
	usb0_pins: usb0 {
		pinmux = <RZG2L_PORT_PINMUX(5, 3, 1)>; /* OTG_ID */
	};
	usb1_pins: usb1 {
		pinmux = <RZG2L_PORT_PINMUX(6,1,1)>, /* USB1_OVRCUR_D */
				 <RZG2L_PORT_PINMUX(6,0,1)>; /* USB1_VBUSEN_D */
	};
};
&sdhi1 {
	pinctrl-0 = <&sdhi1_pins>;
	//pinctrl-1 = <&sdhi1_pins_uhs>;
	//pinctrl-names = "default", "state_uhs";
	pinctrl-names = "default";

	vmmc-supply = <&reg_3p3v>;
	vqmmc-supply = <&reg_3p3v>;
	bus-width = <4>;
	sd-uhs-sdr50;
	sd-uhs-sdr104;
	status = "okay";
	#if 1
	non-removable;
	#endif /* FATEK_TEST */
};
&mtu3 {
	pinctrl-0 = <&mtu3_pins>;
	pinctrl-names = "default";
	pwm_mode1 = <4 0>;
	#pwm-cells = <2>;

	status = "okay";
};
&spi2 {
	pinctrl-0 = <&rspi2_pins>;
	pinctrl-names = "default";

	status = "okay";
	ads7846@0 {
		compatible = "ti,ads7846";
		vcc-supply = <&reg_3p3v>;

		reg = <0>;						/* CS0 */
		spi-max-frequency = <1000000>;

		interrupt-parent = <&pinctrl>;
		interrupts = <RZG2L_GPIO(9, 3) IRQ_TYPE_LEVEL_LOW>;
		pendown-gpio = <&pinctrl RZG2L_GPIO(9, 3) GPIO_ACTIVE_HIGH>;

		ti,x-min = /bits/ 16 <0x0>;
		ti,x-max = /bits/ 16 <0x0fff>;
		ti,y-min = /bits/ 16 <0x0>;
		ti,y-max = /bits/ 16 <0x0fff>;
		ti,x-plate-ohms = /bits/ 16 <180>;
		ti,pressure-max = /bits/ 16 <255>;
		ti,debounce-max = /bits/ 16 <10>;
		ti,debounce-tol = /bits/ 16 <15>;
		ti,debounce-rep = /bits/ 16 <1>;
		ti,keep-vref-on = /bits/ 16 <1>;
		ti,vref-delay-usecs = /bits/ 16 <100>;
		ti,vref-mv = /bits/ 16 <5000>;
		ti,settle-delay-usec = /bits/ 16 <100>;
		ti,penirq-recheck-delay-usecs = /bits/ 16 <100>;

		wakeup-source;
	};
};
&eth0 {
	pinctrl-0 = <&eth0_pins>;
	pinctrl-names = "default";

	status = "okay";

	phy-handle = <&phy0>;
	phy-mode = "mii";
};
&i2c0 {
	pinctrl-names = "default";
	pinctrl-0 = <&i2c0_pins>;
	status = "okay";

	/delete-node/ versa3@68;
	/delete-node/ camera@3c;
};
&i2c1 {
	pinctrl-names = "default";
	pinctrl-0 = <&i2c1_pins>;
	status = "okay";

	/* use rx8010 rtc */
	rx8010: rx8010@32 {
		compatible = "epson,rx8010";
		reg = <0x32>;
	};

	/delete-node/ codec@1a;
};
&scif0 {
	pinctrl-0 = <&scif0_pins>;
	pinctrl-names = "default";

	status = "okay";
};
&scif1 {
	pinctrl-0 = <&scif1_pins>;
	pinctrl-names = "default";

	status = "okay";
};
&scif2 {
	pinctrl-0 = <&scif2_pins>;
	pinctrl-names = "default";

	status = "okay";
};
&scif4 {
	pinctrl-0 = <&scif4_pins>;
	pinctrl-names = "default";

	status = "okay";
};
&sci1 {
	pinctrl-0 = <&sci1_pins>;
	pinctrl-names = "default";

	status = "okay";
};
&sbc {
	pinctrl-0 = <&qspi0_pins>;
	pinctrl-names = "default";

	status = "okay";

	flash@0 {
		compatible = "winbond,w25q256", "jedec,spi-nor";
	};
};
#else
/ {
	model = "Renesas SMARC EVK based on r9a07g043u11";
	compatible = "renesas,smarc-evk", "renesas,r9a07g043u11", "renesas,r9a07g043";
};
#endif /* FATEK_MODIFY */
